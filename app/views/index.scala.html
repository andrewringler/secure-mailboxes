@(twilioAuthToken: String)

@main("Secure Mailboxes Admin") {
    
<script>
  
    /* Create the Client with a Capability Token */
    Twilio.Device.setup("@twilioAuthToken", {debug: true});
 
    /* Let us know when the client is ready. */
    Twilio.Device.ready(function (device) {
        $("#log").text("Ready");
    });
 
    /* Report any errors on the screen */
    Twilio.Device.error(function (error) {
        $("#log").text("Error: " + error.message);
    });
 
    Twilio.Device.connect(function (conn) {
        $("#log").text("Successfully established call");
    });
 
    /* Log a message when a call disconnects. */
    Twilio.Device.disconnect(function (conn) {
        $("#log").text("Call ended");
    });
    
    /* Connect to Twilio when we call this function. */
    function call() {
        Twilio.Device.connect({
        	  type: "secure_patient_message",
        	  patient_id: "4158675309"
        });
    }
    /* A function to end a connection to Twilio. */
    function hangup() {
        Twilio.Device.disconnectAll();
    }
</script>
    
<button class="call" onclick="call();">
	Call
</button>
  
<button class="hangup" onclick="hangup();">
    Hangup
</button>  
  
<div id="log">Loading pigeons...</div>    
    
}
